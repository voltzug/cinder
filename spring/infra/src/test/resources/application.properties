# Test properties for infra module
# Purpose: keep tests isolated from DB, JPA and observation/metrics wiring.
# Tests mock DB and other integrations; do not auto-configure JDBC/JPA/metrics.

# Exclude core auto-configurations that would attempt to create a DataSource / JPA stack
spring.autoconfigure.exclude=\
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceInitializationAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\
org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration,\
org.springframework.boot.actuate.autoconfigure.metrics.MetricsAutoConfiguration,\
org.springframework.boot.actuate.autoconfigure.metrics.export.simple.SimpleMetricsExportAutoConfiguration

# Defensive re-checks to ensure JPA/SQL initialization is fully disabled at runtime
spring.jpa.enabled=false
spring.jpa.hibernate.ddl-auto=none
spring.sql.init.mode=never
spring.sql.init.enabled=false
spring.datasource.initialization-mode=never

# If a single test needs an in-memory DB, uncomment these lines locally for that test run.
# They are intentionally commented to prevent accidental DB wiring in CI.
# spring.datasource.url=jdbc:sqlite::memory:
# spring.datasource.driver-class-name=org.sqlite.JDBC
# spring.jpa.hibernate.ddl-auto=update
# spring.jpa.show-sql=false

# Prevent credential store lookups / external secrets during unit tests
cinder.pepper-hex=